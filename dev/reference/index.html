<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>List of functions · DiffusionGarnet.jl</title><meta name="title" content="List of functions · DiffusionGarnet.jl"/><meta property="og:title" content="List of functions · DiffusionGarnet.jl"/><meta property="twitter:title" content="List of functions · DiffusionGarnet.jl"/><meta name="description" content="Documentation for DiffusionGarnet.jl."/><meta property="og:description" content="Documentation for DiffusionGarnet.jl."/><meta property="twitter:description" content="Documentation for DiffusionGarnet.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="DiffusionGarnet.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">DiffusionGarnet.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../background/">Background</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../diffusion_1D/">Diffusion in 1D Cartesian coordinates</a></li><li><a class="tocitem" href="../diffusion_spherical/">Diffusion in spherical coordinates</a></li><li><a class="tocitem" href="../comparing_diffcoef/">Using different diffusion coefficient datasets</a></li><li><a class="tocitem" href="../diffusion_2D/">Diffusion in 2D Cartesian coordinates on CPU</a></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Callbacks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../updating_PT/">Updating pressure and temperature conditions</a></li><li><a class="tocitem" href="../saving_output/">Saving output as HDF5 files</a></li></ul></li><li><a class="tocitem" href="../diffusion_3D_CPU/">Diffusion in 3D Cartesian coordinates on CPU</a></li><li><a class="tocitem" href="../diffusion_3D_GPU/">Diffusion in 3D Cartesian coordinates on GPU</a></li></ul></li><li class="is-active"><a class="tocitem" href>List of functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>List of functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>List of functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Iddingsite/DiffusionGarnet.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/main/docs/src/reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><ul><li><a href="#DiffusionGarnet.Domain"><code>DiffusionGarnet.Domain</code></a></li><li><a href="#DiffusionGarnet.Domain"><code>DiffusionGarnet.Domain</code></a></li><li><a href="#DiffusionGarnet.Domain"><code>DiffusionGarnet.Domain</code></a></li><li><a href="#DiffusionGarnet.Domain"><code>DiffusionGarnet.Domain</code></a></li><li><a href="#DiffusionGarnet.Domain"><code>DiffusionGarnet.Domain</code></a></li><li><a href="#DiffusionGarnet.D_update!"><code>DiffusionGarnet.D_update!</code></a></li><li><a href="#DiffusionGarnet.IC1DMajor-Tuple{}"><code>DiffusionGarnet.IC1DMajor</code></a></li><li><a href="#DiffusionGarnet.IC2DMajor-Tuple{}"><code>DiffusionGarnet.IC2DMajor</code></a></li><li><a href="#DiffusionGarnet.IC3DMajor-Tuple{}"><code>DiffusionGarnet.IC3DMajor</code></a></li><li><a href="#DiffusionGarnet.ICSphMajor-Tuple{}"><code>DiffusionGarnet.ICSphMajor</code></a></li><li><a href="#DiffusionGarnet.save_data-Tuple{Any}"><code>DiffusionGarnet.save_data</code></a></li><li><a href="#DiffusionGarnet.save_data_paraview-Tuple{Any}"><code>DiffusionGarnet.save_data_paraview</code></a></li><li><a href="#DiffusionGarnet.simulate-Tuple{DiffusionGarnet.Domain1DMajor}"><code>DiffusionGarnet.simulate</code></a></li><li><a href="#DiffusionGarnet.simulate-Tuple{DiffusionGarnet.Domain3DMajor}"><code>DiffusionGarnet.simulate</code></a></li><li><a href="#DiffusionGarnet.simulate"><code>DiffusionGarnet.simulate</code></a></li><li><a href="#DiffusionGarnet.simulate-Tuple{DiffusionGarnet.Domain2DMajor}"><code>DiffusionGarnet.simulate</code></a></li><li><a href="#DiffusionGarnet.simulate-Tuple{DiffusionGarnet.DomainSphericalMajor}"><code>DiffusionGarnet.simulate</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.Domain" href="#DiffusionGarnet.Domain"><code>DiffusionGarnet.Domain</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Domain(IC::IC3DMajor, T::Union{Unitful.Temperature,Array{&lt;:Unitful.Temperature{&lt;:Real}, 1}}, P::Union{Unitful.Pressure,Array{&lt;:Unitful.Pressure{&lt;:Real}, 1}}, time_update::Union{Unitful.Time,Array{&lt;:Unitful.Time{&lt;:Real}, 1}}=0u&quot;Myr&quot;)</code></pre><p>When applied to 3D initial conditions, define corresponding 3D domain.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/input/initialconditions_major.jl#L741-L745">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.Domain" href="#DiffusionGarnet.Domain"><code>DiffusionGarnet.Domain</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Domain(IC::IC2DMajor, T::Union{Unitful.Temperature,Array{&lt;:Unitful.Temperature{&lt;:Real}, 1}}, P::Union{Unitful.Pressure,Array{&lt;:Unitful.Pressure{&lt;:Real}, 1}}, time_update::Union{Unitful.Time,Array{&lt;:Unitful.Time{&lt;:Real}, 1}}=0u&quot;Myr&quot;)</code></pre><p>When applied to 2D initial conditions, define corresponding 2D domain.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/input/initialconditions_major.jl#L721-L725">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.Domain" href="#DiffusionGarnet.Domain"><code>DiffusionGarnet.Domain</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Domain(IC::InitialConditions1D, T::Union{Unitful.Temperature,Array{&lt;:Unitful.Temperature{&lt;:Real}, 1}}, P::Union{Unitful.Pressure,Array{&lt;:Unitful.Pressure{&lt;:Real}, 1}}, time_update::Union{Unitful.Time,Array{&lt;:Unitful.Time{&lt;:Real}, 1}}=0u&quot;Myr&quot;; bc_neumann::Tuple=(false, false))</code></pre><p>When applied to 1D initial conditions, define corresponding 1D domain. <code>bc_neumann</code> can be used to define Neumann boundary conditions on the left or right side of the domain if set to true.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/input/initialconditions_major.jl#L680-L684">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.Domain" href="#DiffusionGarnet.Domain"><code>DiffusionGarnet.Domain</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Domain(IC::InitialConditionsSpherical, T::Union{Unitful.Temperature,Array{&lt;:Unitful.Temperature{&lt;:Real}, 1}}, P::Union{Unitful.Pressure,Array{&lt;:Unitful.Pressure{&lt;:Real}, 1}}, time_update::Union{Unitful.Time,Array{&lt;:Unitful.Time{&lt;:Real}, 1}}=0u&quot;Myr&quot;)</code></pre><p>When applied to spherical initial conditions, define corresponding spherical domain. Assume that the center of the grain is on the left side.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/input/initialconditions_major.jl#L700-L704">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.Domain" href="#DiffusionGarnet.Domain"><code>DiffusionGarnet.Domain</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Domain(IC, T, P, time_update=0u&quot;Myr&quot;)</code></pre><p>Return a struct containing the struct <code>IC</code>, the PT conditions <code>T</code> and <code>P</code>  and the nondimensionalised parameters of the problem. <code>time_update</code> can be used to update the PT conditions during the simulation. If so, <code>T</code> and <code>P</code> have to be of the same size as <code>time_update</code> and correspond to the values of PT to update to.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/input/initialconditions.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.D_update!" href="#DiffusionGarnet.D_update!"><code>DiffusionGarnet.D_update!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">D_update!(D0, T_K, P_kbar, diffcoef, CMg, CFe, CMn, X, fugacity_O2=1e-25NoUnits)</code></pre><p>Update the diffusion coefficients <code>D0</code> based on the temperature <code>T_K</code>, pressure <code>P_kbar</code>, and the chemical compositions <code>CMg</code>, <code>CFe</code>, and <code>CMn</code>. The optional parameter <code>fugacity_O2</code> is used to set the oxygen fugacity, defaulting to 1e-25 Pa (graphite buffer).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/callbacks/update_diffusion_coef_TP.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.IC1DMajor-Tuple{}" href="#DiffusionGarnet.IC1DMajor-Tuple{}"><code>DiffusionGarnet.IC1DMajor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">IC1DMajor(CMg0::Array{&lt;:Real}, CFe0::Array{&lt;:Real}, CMn0::Array{&lt;:Real}, Lx::Unitful.Length, x::AbstractArray{&lt;:Unitful.Length}=range(0u&quot;µm&quot;, length=size(CMg0, 1), stop=Lx), tfinal::Unitful.Time)</code></pre><p>Return a structure containing the initial conditions for a 1D diffusion problem. CMg0, CFe0 and CMn0 need to be in molar fraction. Convert <code>Lx</code>, <code>x</code>, and <code>tfinal</code> to µm, µm and Myr, respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/input/initialconditions_major.jl#L158-L162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.IC2DMajor-Tuple{}" href="#DiffusionGarnet.IC2DMajor-Tuple{}"><code>DiffusionGarnet.IC2DMajor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">IC2DMajor(;CMg0::AbstractArray{&lt;:Real, 2}, CFe0::AbstractArray{&lt;:Real, 2}, CMn0::AbstractArray{&lt;:Real, 2}, Lx::Unitful.Length, Ly::Unitful.Length, tfinal::Unitful.Time, grt_boundary::AbstractArray{&lt;:Real, 2}=zeros(eltype(CMg0), size(CMg0)...))</code></pre><p>Return a structure containing the initial conditions for a 2D diffusion problem. CMg0, CFe0 and CMn0 need to be in molar fraction. Convert <code>Lx</code>, <code>Ly</code> and <code>tfinal</code> to µm, µm and Myr respectively. grt_boundary is a matrix of the same size as CMg0, CFe0 and CMn0. It is a binary matrix with 1 where the contour of the garnet is present and 0 otherwise. It is used to apply the Dirichlet boundary condition in the model. If not provided, it is equal to zero everywhere.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/input/initialconditions_major.jl#L193-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.IC3DMajor-Tuple{}" href="#DiffusionGarnet.IC3DMajor-Tuple{}"><code>DiffusionGarnet.IC3DMajor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">IC3DMajor(;CMg0::AbstractArray{&lt;:Real, 3}, CFe0::AbstractArray{&lt;:Real, 3}, CMn0::AbstractArray{&lt;:Real, 3}, Lx::Unitful.Length, Ly::Unitful.Length, Lz::Unitful.Length, tfinal::Unitful.Time, grt_boundary::Union{AbstractArray{&lt;:Real, 3}, AbstractArray{&lt;:Bool, 3}}=zeros(Bool, size(CMg0)...))</code></pre><p>Return a structure containing the initial conditions for a 3D diffusion problem. CMg0, CFe0 and CMn0 need to be in molar fraction. Convert <code>Lx</code>, <code>Ly</code>, <code>Lz</code> and <code>tfinal</code> to µm, µm, µm and Myr respectively. grt_boundary is a matrix of the same size as CMg0, CFe0 and CMn0. It is a binary matrix with 1 where the contour of the garnet is present and 0 otherwise. It is used to apply the Dirichlet boundary condition in the model. If not provided, it is equal to zero everywhere.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/input/initialconditions_major.jl#L212-L217">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.ICSphMajor-Tuple{}" href="#DiffusionGarnet.ICSphMajor-Tuple{}"><code>DiffusionGarnet.ICSphMajor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ICSphMajor(CMg0::AbstractArray{&lt;:Real, 1}, CFe0::AbstractArray{&lt;:Real, 1}, CMn0::AbstractArray{&lt;:Real, 1}, Lr::Unitful.Length, tfinal::Unitful.Time)</code></pre><p>Return a structure containing the initial conditions for a spherical diffusion problem. CMg0, CFe0 and CMn0 need to be in molar fraction. Convert <code>Lr</code> and <code>tfinal</code> to µm and Myr respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/input/initialconditions_major.jl#L176-L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.save_data-Tuple{Any}" href="#DiffusionGarnet.save_data-Tuple{Any}"><code>DiffusionGarnet.save_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_data(integrator)</code></pre><p>Callback function used to save major element compositions to an HDF5 file at a specific timestep.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/callbacks/output.jl#L211-L215">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.save_data_paraview-Tuple{Any}" href="#DiffusionGarnet.save_data_paraview-Tuple{Any}"><code>DiffusionGarnet.save_data_paraview</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_data_paraview(integrator)</code></pre><p>Callback function used to save data to an HDF5 file and produce an XMDF file. XMDF files can be used to read data on software like Paraview.</p><p>Note that data are saved in row major format. For column major, use <code>save_data()</code> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/callbacks/output_paraview.jl#L208-L214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.simulate" href="#DiffusionGarnet.simulate"><code>DiffusionGarnet.simulate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate(domain; path_save=nothing, solver=ROCK2(), p_extra = nothing, kwargs...)</code></pre><p>Solve the coupled major element diffusion equations for a given domain using finite differences for the discretisation in space and return a solution type variable.</p><p>The default time discretisation is based on the ROCK2 method, a stabilized explicit method (Adbdulle and Medovikov, 2001) using OrdinaryDiffEq.</p><p>The solution type variable is following the format of OrdinaryDiffEq.jl (see https://docs.sciml.ai/DiffEqDocs/stable/basics/solution/), and can be used to plot the solution, and to extract the solution at a given time. The time of the solution is non-dimensional but can be converted back using the characteristic time (<code>t_charact</code> contained in the <code>Domain</code> structure).</p><p><code>path_save</code> is an optional argument, which can be used to define the path of the HDF5 output file. Default is to nothing.</p><p><code>solver</code> is an optional argument, which can be used to define the solver to use for the time discretisation. Default is the ROCK2 method. All other ODE solvers accepted as the ones from DifferentialEquations (see https://docs.sciml.ai/DiffEqDocs/stable/solvers/ode_solve/).</p><p><code>p_extra</code> is an optional argument that can be used to pass additional parameters to the ODEProblem. It is not used by default, but can be useful to write custom callbacks.</p><p>All other accepted arguments such as <code>callback</code> or <code>progress</code> are the same as those of the <code>solve</code> function from DifferentialEquations (see https://docs.sciml.ai/DiffEqDocs/stable/basics/common<em>solver</em>opts/).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/simulate/simulate.jl#L2-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.simulate-Tuple{DiffusionGarnet.Domain1DMajor}" href="#DiffusionGarnet.simulate-Tuple{DiffusionGarnet.Domain1DMajor}"><code>DiffusionGarnet.simulate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate(domain::Domain1DMajor; path_save=nothing, solver=ROCK2(), abstol=1e-8, reltol=1e-4, p_extra = nothing, kwargs...)</code></pre><p>Solve the coupled major element diffusion equations in 1D. Save all timesteps in the output solution type variable by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/simulate/simulate.jl#L21-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.simulate-Tuple{DiffusionGarnet.Domain2DMajor}" href="#DiffusionGarnet.simulate-Tuple{DiffusionGarnet.Domain2DMajor}"><code>DiffusionGarnet.simulate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate(domain::Domain2D; path_save=nothing, solver=ROCK2(), p_extra = nothing, kwargs...)</code></pre><p>Solve the coupled major element diffusion equations in 2D. By default, save only the first and last timestep in the output solution type variable by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/simulate/simulate.jl#L104-L108">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.simulate-Tuple{DiffusionGarnet.Domain3DMajor}" href="#DiffusionGarnet.simulate-Tuple{DiffusionGarnet.Domain3DMajor}"><code>DiffusionGarnet.simulate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate(domain::Domain3D; path_save=nothing, solver=ROCK2(), p_extra = nothing, kwargs...)</code></pre><p>Solve the coupled major element diffusion equations in 3D. Save only the first and last timestep in the output solution type variable by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/simulate/simulate.jl#L124-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DiffusionGarnet.simulate-Tuple{DiffusionGarnet.DomainSphericalMajor}" href="#DiffusionGarnet.simulate-Tuple{DiffusionGarnet.DomainSphericalMajor}"><code>DiffusionGarnet.simulate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate(domain::DomainSpherical; path_save=nothing, solver=ROCK2(), abstol=1e-8, reltol=1e-4, p_extra = nothing, kwargs...)</code></pre><p>Solve the coupled major element diffusion equations in spherical coordinates. Save all timesteps in the output solution type variable by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Iddingsite/DiffusionGarnet.jl/blob/dbd1e041f1b2ec23194b73861ede7fbff3e0e542/src/simulate/simulate.jl#L63-L67">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../diffusion_3D_GPU/">« Diffusion in 3D Cartesian coordinates on GPU</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 19 August 2025 15:33">Tuesday 19 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
